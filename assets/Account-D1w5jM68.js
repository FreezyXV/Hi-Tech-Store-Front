import{r as a,t as Y,j as s,v as H,w as J}from"./index-DbVRvJPY.js";import{F as Q}from"./Footer-BWtx0ILX.js";/* empty css             */import"react-toastify";import"react-toastify/dist/ReactToastify.css";const K=()=>{const[n,d]=a.useState(null),[h,u]=a.useState(!0),[i,w]=a.useState(null),[p,N]=a.useState(""),[o,v]=a.useState(""),[f,P]=a.useState(""),[S,c]=a.useState(""),[C,b]=a.useState(""),[m,y]=a.useState(!1),[g,O]=a.useState([]),[E,W]=a.useState({}),x=Y();a.useEffect(()=>{const e=async()=>{try{const t=localStorage.getItem("authToken");if(!t){x("/login");return}const l=await H(t);l?d(l):w("User data is unavailable")}catch(t){w(t.message||"Error fetching user profile")}finally{u(!1)}},r=()=>{try{const t=localStorage.getItem("wishlist");O(t?JSON.parse(t):[])}catch(t){console.error("Error loading wishlist from localStorage:",t)}};e(),r()},[x]);const _=async e=>{if(e.preventDefault(),c(""),b(""),o!==f){c("New passwords do not match");return}if(o.length<6){c("New password must be at least 6 characters long");return}try{const r=localStorage.getItem("authToken");if(!r)throw new Error("No token found");await J(r,{currentPassword:p,newPassword:o}),b("Password changed successfully"),N(""),v(""),P(""),y(!1)}catch(r){c(r.message||"Error changing password")}},q=()=>{localStorage.removeItem("authToken"),x("/login")},T=e=>{W(r=>({...r,[e]:!r[e]}))};return h?s.jsx("div",{children:"Loading..."}):i?s.jsx("div",{children:`Error: ${i}`}):n?s.jsxs("div",{className:"body",children:[s.jsx("h1",{className:"account-title",children:"Account"}),s.jsxs("div",{className:"account-container",children:[s.jsxs("p",{children:["Welcome, ",s.jsx("strong",{children:n.username}),"!"]}),s.jsxs("p",{children:["Email: ",s.jsx("strong",{children:n.email})]}),s.jsxs("p",{children:["Account Created On:"," ",s.jsx("strong",{children:new Date(n.createdAt).toLocaleDateString()})]}),s.jsxs("div",{className:"account-options",children:[s.jsx("button",{className:"account-button",onClick:q,children:"Logout"}),s.jsx("button",{className:"account-button",onClick:()=>y(!m),children:m?"Cancel":"Change Password"})]}),m&&s.jsxs("div",{className:"change-password-section",children:[s.jsxs("form",{onSubmit:_,children:[s.jsx(j,{label:"Current Password",type:"password",value:p,onChange:e=>N(e.target.value),required:!0}),s.jsx(j,{label:"New Password",type:"password",value:o,onChange:e=>v(e.target.value),required:!0}),s.jsx(j,{label:"Confirm New Password",type:"password",value:f,onChange:e=>P(e.target.value),required:!0}),s.jsx("button",{type:"submit",className:"account-button",children:"Change Password"})]}),S&&s.jsx("div",{className:"error",children:S}),C&&s.jsx("div",{className:"success",children:C})]})]}),s.jsxs("div",{className:"order-wishlist-containers",children:[s.jsxs("div",{className:"ordershistory-container",children:[s.jsx("h2",{children:"Your Orders"}),n.orders&&n.orders.length>0?n.orders.map(e=>{var r;return s.jsxs("div",{className:"order-card",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Order ID:"})," ",e._id]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Date:"})," ",new Date(e.createdAt).toLocaleDateString()]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Status:"})," ",e.status]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Total:"})," €",((r=e.totalAmount)==null?void 0:r.toFixed(2))||"N/A"]}),s.jsx("button",{onClick:()=>T(e._id),className:"toggle-order-details-btn",children:E[e._id]?"Hide Details":"Show Details"}),E[e._id]&&s.jsx("ul",{className:"order-items-list",children:e.items&&e.items.length>0?e.items.map(t=>{var k,D,U,A,F,I,L;const l=((D=(k=t.variant)==null?void 0:k.imageUrls)==null?void 0:D[0])||"https://via.placeholder.com/150";return s.jsxs("li",{className:"order-item",children:[s.jsx("img",{src:l,alt:((U=t.variant)==null?void 0:U.name)||"Unknown Product"}),s.jsxs("div",{className:"order-item-details",children:[s.jsx("p",{className:"item-name",children:((A=t.variant)==null?void 0:A.name)||"Unknown Product"}),s.jsxs("p",{className:"item-quantity",children:["Quantity: ",t.quantity||1]}),s.jsxs("p",{className:"item-price",children:["Price: €",((I=(F=t.variant)==null?void 0:F.price)==null?void 0:I.toFixed(2))||"N/A"]})]})]},((L=t.variant)==null?void 0:L._id)||t._id)}):s.jsx("li",{children:"No items in this order."})})]},e._id)}):s.jsx("p",{children:"You have no orders yet."})]}),s.jsxs("div",{className:"wishlist-container",children:[s.jsx("h2",{children:"Your Wishlist"}),g&&g.length>0?s.jsx("ul",{children:g.map(e=>{var r;return s.jsxs("li",{className:"wishlist-item",children:[s.jsx("img",{src:e.imageUrls||"https://via.placeholder.com/150",alt:e.name||"Wishlist Item"}),s.jsx("strong",{children:e.name||"Wishlist Item"}),s.jsxs("p",{className:"wishlist-item-price",children:["€",((r=e.price)==null?void 0:r.toFixed(2))||"N/A"]})]},e.id)})}):s.jsx("p",{children:"Your wishlist is empty."})]})]}),s.jsx(Q,{})]}):s.jsx("div",{children:"Error: User data is unavailable"})},j=({label:n,type:d,value:h,onChange:u,required:i})=>s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{children:[n,":"]}),s.jsx("input",{type:d,value:h,onChange:u,required:i})]});export{K as default};
